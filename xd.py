import os
import pandas as pdrootPath = "C:\\test\\"def createOutCsv(path):data = pd.read_excel(path, names=["column1", "column2", "column3"])data.drop(index=[0], inplace=True)header = ["name"]  ###创建表头for index in data.index:  ##利用data中的所有column1创建表头column = data.loc[index,"name"].split(".")[-1]header.append(column)outData = pd.DataFrame(columns=header)  ##创建表格return outData# Press the green button in the gutter to run the script.
if __name__ == '__main__':path = rootPath + "test.xlsx"rootData = createOutCsv(path)csvNames = os.listdir(rootPath)numCsvPro = 1for csvName in csvNames:print("No.",numCsvPro," + Name: ",csvName)numCsvPro = numCsvPro + 1csvPath = rootPath+csvNamedata = pd.read_excel(csvPath, names=["column1", "column2", "column3"])data.drop(index=[0], inplace=True)data.iloc[:, :] = data.iloc[:, :].astype(str)rowData = []rowData.append(csvName)for index in range(1, len(data)+1):subData = []if data.loc[index, "column3"] != "nan" :propo = data.loc[index, "column3"].split(" ")for i in range(len(propo)-1):subData.append(int(propo[i].split(":")[0]))# subData.append(" ")elif data.loc[index, "column2"] != "nan":num = data.loc[index, "column2"].split(" ")frame = int(data.loc[index, "column1"].split("..")[0])for i in range(len(num)-1):if(int(num[i])!=0):subData.append(frame)frame = frame + 1rowData.append(subData)rootData.loc[str(csvName)] = rowDatasaveFile = rootPath+"outData.xlsx"rootData.to_excel(saveFile,index=False)
